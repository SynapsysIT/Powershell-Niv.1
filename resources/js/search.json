[[{"l":"Introduction"},{"i":"quest-ce-que-powershell-","l":"Qu'est ce que Powershell ?","p":["Powershell est avant tout un shell, c’est-à-dire une interface utilisateur permettant de traduire les commandes utilisateurs en exécution au niveau du système."]},{"i":"pourquoi-se-former-à-powershell-","l":"Pourquoi se former à Powershell ?","p":["Intéropérable avec l'ensemble de l'écosystème Microsoft, des APIs tierce, etc...","Productivité: Une action manuelle sur un élément prendra plus de temps que cette même action sur 1000 éléments en Powershell.","Standardisation: Une fois le code établi, son action sera toujours la même, sans oublis ou mauvaise manipulation"]}],[{"l":"Exécuter des commandes"},{"l":"Syntaxe des commandes","p":["Syntax Toutes les commandes PowerShell, appelés CmdLets se composent d’un verbe et d’un nom séparé par un tiret. Le résultat de la commande peut être influencer par l'ajout de paramètres.","Par exemple, la commande Get-Service exécutée telle quelle, renverra l'ensemble des services.","Tandis que la commande Get-Service -Name *Net* ne renverra que les services contenant net dans leur nom.","Chaque verbe correspond à un type d'action précis :","Verb","Action","Requeter","Configurer / Définir","Importer","etc ...","...","permet d'obtenir la liste des verbs approuvés par les best-practices Powershell"]},{"l":"Les 3 commandes indispensables"},{"l":"Get-Command","p":["permet de rechercher une commande en fonction de nom, de son verb ou de son module d'appartenance."]},{"l":"Get-Help","p":["La commande permet d'obtenir une aide sur le fonctionnement d'une commande.","Elle vous permet d'identifier les paramètres attendues, lesquels sont obligatoires ou non, le type de valeurs à leur envoyer, etc ...","L'ajout du paramètre -Online à la commande Get-Help vous envoie sur la page Microsoft Docs correspondante."]},{"l":"Get-Member","p":["vous permet d'obtenir \"la carte d'identité\" d'un objet obtenu par l'éxécution d'une commande ou stockée dans une variable. Elle vous permettra de connaitre:","Son type","Ses propriétés","Ses méthodes","Commande","Description","Lister et chercher des commandes","Obtenir l'aide d'une commande","Connaitre le type, les propriétés et les méthodes d’un objet"]}],[{"i":"pipeline--objets","l":"Pipeline & Objets"},{"l":"Language Objet","p":["Contrairement à Batch ou Bash qui sont des langages dit « textes », Powershell est un langage objet.","Sous PowerShell, chaque commande renverra un objet d’un type précis possédant ses propriétés et ses méthodes."]},{"l":"Le Pipeline","p":["Le pipeline, symbolisée par le caractère permet de chainer plusieurs commandes entre elles.","Autrement dit, la sortie d'une commande correspond à l' entrée de la suivante.","Les valeurs des paramètres de la deuxième commande lui sont fourni par la première commande."]}],[{"l":"Les variables","p":["La variable est un emplacement mémoire. Elle se compose de 3 éléments :","Un nom","Un type","Une valeur","Sous PowerShell, une variable est précédée du signe :","Le contenu d'une variable peut être une valeur unique, ou une collection d'objets"]},{"l":"Assignation de variables","p":["L'assignation d'une variable se fait avec le symbole","Le résultat d'une commande peut être stocké dans une variable de la même manière","Powershell détermine le type de la variable en fonction de la syntaxe avec laquelle elle est définie"]},{"l":"Forcer le typage","p":["Il peut être néccéssaire d'avoir à forcer le type d'une variable. Pour cela on précise le type voulu entre avant le nom de la variable."]},{"l":"Propriétés et méthodes","p":["Les propriétés et les méthodes de l'objet stocké en variable pourront être appelé par un"]},{"l":"Utilisation dans une commande","p":["Une variable ou seulement ses propriétés pourront être utilisés dans une commande","La syntaxe $($variable.propriete) empêche que la variable ne soit interprété comme une composante de la chaîne de caractère."]}],[{"l":"Array","p":["Une array est une liste de valeur"]},{"l":"Indexage dans une liste"}],[{"l":"Hashtable","p":["Une Hashtable est un tableau de correspondance clé/valeur","Les valeurs peuvent alors être appelés en utilisant leur clé","Ou comme pour appelé la propriété d'un objet"]}],[{"l":"PSCustomObject","p":["Le PSCustomObject permet la création d'un objet personnalisé dans lequel on pourra définire l'ensemble de ses propriétés","Il est possible de compléter l'objet via l'utilisation de la commande Add-Member","Les propriétés peuvent alors être appelés comme n'importe quel autre objet"]}],[{"l":"Variables automatiques","p":["Commande","Description","$?","Contient le statut de la dernière commande. true si éxécutée avec succés, false si elle a échouée","$null","Remprésente une valeur nulle ou indéfinie. Peut-être utilisée pour vider une variable ou envoyer le résultat d'une commande dans un \"trou-noir\"","$error","Contient la liste des erreurs rencontrées dans la session. $Error[0] étant la dernière erreur","$true$false","Représente les valeurs booléenne logique"]}],[{"l":"Comparer des nombres","p":["Commande","Description","2 -eq 2","Egal","2 -ne 4","N'est pas égal","5 -gt 2","Plus grand que","5 -ge 5","Plus grand ou égale","5 -lt 10","Plus petit que","5 -lt 5","Plus petit ou égale"]}],[{"l":"Comparer des chaînes de caractères"},{"i":"egalité--eq","l":"Egalité (-eq)"},{"i":"wildcard--like","l":"Wildcard (-like)"},{"i":"match--match","l":"Match (-match)","p":["-match permet aussi d'utiliser le format Regex pour comparer un format de chaîne attendu avec une valeur:"]},{"i":"présence--contains","l":"Présence (-contains)","p":["-contains permet de vérifier la présence d'une valeur dans une liste","Ces opérateurs, précédés de la lettre ( -ceq, -clike, … ) rend la comparaison sensible à la case","Ces opérateurs, précédés ( -notlike, -notmatch, … ) inverse la comparaison"]}],[{"l":"Opérateurs logiques","p":["Commande","Description","-and","ET","-or","OU","-not","N'est pas ou n'existe pas","-xor","OU Exclusif [\"Le résultat n'est vrai que si une et une seule des valeurs est vrai\"]"]}],[{"l":"Manipuler des chaînes de caractères"},{"i":"remplacer--replace","l":"Remplacer (-replace)"},{"i":"séparer--split","l":"Séparer (-split)","p":["Le résulat obtenu est une array(liste) d'objet de type string"]},{"i":"joindre--join","l":"Joindre (-join)"}],[{"l":"Opérateurs Arithmétiques","p":["$Var -= 2","$Var *= 2","$Var /= 2","$Var + 2","$Var += 2","$Var = 1","$Var--","$Var++","Additionne","Assigne une valeur","Commande","Décrémente","Décrémente par la valeur fournie","Description","Divise par la valeur fournie","Incrémente","Incrémente par la valeur fournie","Multiplie par la valeur fournie"]}],[{"l":"Opérateur de type","p":["Commande","Exemple","Description","-is","99 -is int","Compare le type de l'objet founi et retourne true si égal","-isnot","99 -isnot int","Compare le type de l'objet founi et retourne false si égal","-as","01/09/23 -as [datetime]","Converti la valeur fourni dans un type donnée. Renvoie une erreur si la conversion est impossible","L'opérateur -as peut aussi permettre de vérifier qu'une donnée est correctement formatée:","Cette commande renvoie un objet de type ipaddress","Cette commande ne renverra rien, permettant d'en déduire que le format d'entrée est incorrect."]}],[{"l":"Where-Object","p":["permet de trier une collection pour n'afficher que ceux répondant à des conditions précises."]}],[{"l":"Select-Object","p":["permet de ne sélectionner que certaines propriétés de l'objet ou d'en créer de nouvelles."]},{"i":"afficher-lensemble-des-propriétés","l":"Afficher l'ensemble des propriétés","p":["Select-Object * permettra de renvoyer l'intégralité des propriétés et leur valeurs d'un objet, même si la commande ne les renvoient pas de base."]},{"l":"Créer une propriétés custom"},{"l":"Limiter un résultat","p":["Select-Object possède des paramètres -First et --Last pour ne récupérer qu'un certain nombres d'objets dans une collection."]}],[{"l":"Sort-Object","p":["permet de trier une collection d'objet en fonction de la valeur de ses propriétés","Pour inverser l'ordre:"]}],[{"l":"Group-Object","p":["permet de regrouper les objets d'une collection en fonction de la valeur d'une de leur propriétés. Cette commande renvoie un nouvel objet de type groupinfo"]}],[{"l":"Foreach-Object","p":["permet de réaliser une opération pour chaque objet d'une collection"]},{"l":"Exemples","p":["Créer un fichier readme.txt dans chaque sous-dossier du disque E"]}],[{"l":"Exercice 1","p":["Recherchez la commande permettant de récupérer les infos d'un disque dur.","En utilisant un paramètre de cette commande, n'affichez que le disque 0","N’affichez que la propriété permettant de déterminer si il s’agit du disque System"]}],[{"l":"Exercice 2","p":["Obtenez une liste de 10 nombres aléatoires (random)","Enregistrer dans une variable uniquement le 5ème nombre de cette liste"]}],[{"l":"Exercice 3","p":["Affichez toutes les commandes commancant par Remove","Combien y en a-t-il ? (Non, ne comptez pas à la main \uD83D\uDE04)"]}]]